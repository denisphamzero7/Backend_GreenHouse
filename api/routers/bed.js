const router =  require('express').Router();
const controller = require('../controllers/bedController')
const uploadCloud= require('../config/cloudinary.config')
const {verifyAccessToken,isAdminOrManager,isStaff } = require('../middlewares/verifytoken')
const validate = require('../middlewares/validate')
const bedvalidation = require('../validators/beds.validation')
router.post('/',validate(bedvalidation.createBedSchema),uploadCloud.single('image'),controller.createBed)
router.post('/log/:bedid',validate(bedvalidation.createlogSchema),[verifyAccessToken],controller.addMonitoringLog)
router.get('/historylog',[verifyAccessToken],controller.getBedHistoryLogs)
router.put('/:bedid',validate(bedvalidation.updateBedSchema),uploadCloud.single('image'),controller.updateBed)
router.put('/statuslog/:bedid',validate(bedvalidation.updateBedStatusSchema),uploadCloud.single('image'),controller.bedstatus)
router.get('/',controller.getBeds)
router.get('/log/:bedid',[verifyAccessToken],controller.getMonitoringLogs)
router.get('/:bedid',validate(bedvalidation.getBedByIdSchema),controller.getBed)
router.delete('/',controller.deleteBed)
router.delete('/:bedid/:logid',validate(bedvalidation.deletelogschema),[verifyAccessToken],controller.deleteLogbyId)
router.delete('/history/:bedid/:historyid',[verifyAccessToken],controller.deleteHistoryLogById)
module.exports = router;
